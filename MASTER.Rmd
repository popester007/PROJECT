# PUBPOL599B
# Master Document

# We are going to open the excel file containing the Global Hunger Index data
# This Global Hunger Index  was copied from information on Wikipedia's Global Hunger Index Page (https://en.wikipedia.org/wiki/Global_Hunger_Index) and put into an excel spreadsheet.

# First, install "readxl" to open the file
```{r}
library(readxl)
```

# Whenever we use Excel files, we must use the following:
```{r}
temp = tempfile(fileext = ".xlsx")
```


# To ease reproducibility, the excel sheet is stored online on Github. We can get the data from the link to this page:
```{r}
dataURL <- "https://github.com/popester007/PROJECT/raw/master/project%20data%20GHI.csv"
```

# Now, to download the file temporarily:
```{r}
download.file(dataURL, destfile=temp, mode='wb')
```
# Now to get the file, which we will call ghIndex
```{r}
ghIndex = read.csv(dataURL)
```
# Display the information:
```{r}
head(ghIndex,51)
```

# Next we use the str() command to explore what type of variables the data contains:
```{r}
str(ghIndex)
```

To view the variable names (column headers), use the names() command
```{r}
names(ghIndex)
```

# As you can see, the years are displaying with an "X" in front of each variable. We want to rename these to eliminate the "X"
```{r}
names(ghIndex) <- c("Rank", "Country", "1992", "2000", "2008", "2017")
```

# Re-run the names() command to see if the change worked:
```{r}
names(ghIndex)
```

# Now, run the summary() command to see some statistics on our variables:
```{r}
summary(ghIndex)
```

# If we want to see a scatterplot of this data, load the "car" package and enter the following code:
```{r}
library(car)
scatterplotMatrix(ghIndex[,c(3:6)], diagonal='histogram',reg.line=NULL, smoother=NULL)
```

# Now we will begin univariate analysis of the "1992" variable of the GHI data. We can replicate this process for any of the "year" variables, but to start we will just look at 1992.

# To start, we will download the "e1071" package and load it. This package contains a variety of statistical functions we will use:
```{r}
library(e1071)
```


# Then start with a summary() command to view centrality of the 1992 variable:
```{r}
summary(ghIndex$'1992',na.rm=T)
```

# To analyze dispersion, we run the sd() code to get the standard deviation and coefficient of variation:
```{r}
sd(ghIndex$'1992',na.rm = T)
```

# Next, we will look at skewness:
```{r}
skewness(ghIndex$'1992',na.rm = T)
```

# Now we will analyze Kurtosis:
```{r}
kurtosis(ghIndex$'1992',na.rm = T)
```

# With these measures calculated, we can now create a histogram for analysis. 
# Start with the follow code to keep non missing:
```{r}
data=ghIndex[is.finite(ghIndex$'1992'),]
```

# Next, we will select the 1992 variable with the following code:
```{r}
var=data$'1992'
```

# To save the mean and standard deviation:
```{r}
mnVar=mean(var,na.rm = T)
sdVar=sd(var,na.rm = T)
```

# Now we will begin visualizing our data. 
# We start by loading the "ggplot2" package, which is used to create data visualizations. We will make a histogram for the moment.
```{r}
library(ggplot2)
```

# Now, run the following code to create the histogram.
```{r}
base = ggplot(data, aes(x=var))
hist = base + geom_histogram(fill="green",
                             color='grey',
                             aes(y=..density..))
```
# Followed by this code:
```{r}
histAndNormal = hist + stat_function(fun=dnorm,
                                     color="red",
                                     args=list(mean=mnVar,sd=sdVar))
```
# Now to see the histogram:
```{r}
histAndNormal
```

# Next, we want to view the histogram with central measures.

# We will start with the median:
```{r}
mdVar=median(var)
```

# Now we will add vertical lines to mark the median and mean
```{r}
histAndNormal + geom_vline(aes(xintercept = mnVar, colour="mean"),
                           show.legend = TRUE) +
  geom_vline(aes(xintercept = mdVar,colour="median"),
             show.ledgend = TRUE) +
  scale_color_manual(name = "centrals",
                     values = c(median = "blue", mean = "red"))
```

# Next, we want to identify if there are any outliers in the 1992 variable.

# Run the summary() code again:
```{r}
summary(ghIndex$'1992')
```

# Now, we create a box plot to visualize this information:
```{r}
(bp=boxplot(ghIndex$'1992',horizontal = T))
```

# Then, run "bp" to find the quartiles
```{r}
bp$stats
```

# Next, we calculate the Interquartile Range:
```{r}
(iqr=IQR(ghIndex$'1992',na.rm = T))
```

# Now we find the 75th Quartile
```{r}
q75=bp$stats[4]
(capHigh = q75 + iqr*1.5)
```

# Then, the 25th Q
```{r}
q25=bp$stats[2]
(capLow=q25 - iqr*1.5)
```

# Any value above the High value (73.575) or below the Low value (15.775) is an outlier
```{r}
length(bp$out)
```

# In this case, the 1992 does not have any outliers. If we were to repeat this entire process with another variable (year), we might encounter some. 

#
```{r}
StdDev=sd(ghIndex$'1992',na.rm = T)
Mean=mean(ghIndex$'1992',na.rm = T)
```

```{r}
(lowCapT=Mean-2*StdDev)
```

```{r}
(upCapT=Mean+2*StdDev)
```